---

instances_keypair: "{{ec2_keypair}}"
image_id: "{{ec2_image}}"

security_groups:
  - name: jumphost
    desc: the security group for the jumphost
    rules:
      - proto: tcp
        from_port: 22
        to_port: 22
        cidr_ip: 0.0.0.0/0
  - name: cassandra
    desc: the security group for cassandra
    rules:
      - proto: tcp
        from_port: "{{ cassandra_intermode_port }}"
        to_port: "{{ cassandra_intermode_port }}" 
        cidr_ip: 0.0.0.0/0
      - proto: tcp
        from_port: "{{ cassandra_native_port }}"
        to_port: "{{ cassandra_native_port }}"
        cidr_ip: 0.0.0.0/0

ec2_instances:

  - instance_type: m1.small
    image: "{{image_id}}"
    keypair: "{{instances_keypair}}"
    group: jumphost
    instance_tags: 
        Name: dev_jumphost
        dev_jumphost: ""
    exact_count: 1
    count_tag: 
        Name: dev_jumphost

  - instance_type: m1.large
    image: "{{image_id}}"
    keypair: "{{instances_keypair}}"
    group: cassandra 
    instance_tags: 
        Name: dev_db
        dev_all: ""
        dev_cassandra: ""
        cassandra: ""
    exact_count: 1 
    count_tag: 
        Name: dev_db

  - instance_type: m1.large
    image: "{{image_id}}"
    keypair: "{{instances_keypair}}"
    group: cassandra
    instance_tags: 
        Name: dev_db_seed
        dev_all: ""
        dev_cassandra: ""
        cassandra: ""
    exact_count: 1 
    count_tag: 
        Name: dev_db_seed

  - instance_type: m1.large
    image: "{{image_id}}"
    keypair: "{{instances_keypair}}"
    group: default
    instance_tags: 
        Name: dev_app
        dev_all: ""
    exact_count: 0
    count_tag: 
        Name: dev_app

  - instance_type: m1.large
    image: "{{image_id}}"
    keypair: "{{instances_keypair}}"
    group: default
    instance_tags: 
        Name: dev_proxy
        dev_all: ""
    exact_count: 0 
    count_tag: 
        Name: dev_proxy
