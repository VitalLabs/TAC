---
- name: Deploy the initial common configuration and setup for DSE hosts
  hosts: tag_Name_{{environ|default('dev')}}_db:tag_Name_{{environ|default('dev')}}_db_seed
  remote_user: ubuntu
  sudo: true

  vars_files:
  - vars/main.yml

  pre_tasks:

  roles:
  - common
  - java
  - {role: db-dse, tags: ["datastax"]}

- name: Bring up Cassandra seed(s) in serial
  hosts: tag_Name_{{environ|default('dev')}}_db_seed
  remote_user: ubuntu
  sudo: true
  serial: 1

  vars_files:
  - vars/main.yml

  roles:
  - {role: dse-cassandra-start, tags: ["datastax"]}

- name: Bring up the rest of the Cassandra hosts
  hosts: tag_Name_{{environ|default('dev')}}_db
  remote_user: ubuntu
  sudo: true
  
  vars_files:
  - vars/main.yml

  roles:
  - {role: dse-cassandra-start, tags: ["datastax"]}
