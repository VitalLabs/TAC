LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so
LoadModule proxy_http_module /usr/lib/apache2/modules/mod_proxy_http.so
LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so
LoadModule deflate_module /usr/lib/apache2/modules/mod_deflate.so
LoadModule cache_module /usr/lib/apache2/modules/mod_cache.so

# Put this with your other VirtualHosts, or at the bottom of the file

 <VirtualHost *:80>
    ServerName {{ orchestra_vhost }}
 	DocumentRoot {{ app_dir }}{{ app_root }}/out/public
	DirectoryIndex orchestra.html

#	MCacheSize 16394
#	MCacheMaxObjectCount 100
# 	MCacheMinObjectSize 1
#	MCacheMaxObjectSize 4096000

    ProxyPass /api http://localhost:{{ switchboard_proxy_port }}/api
    ProxyPassReverse /api http://localhost:{{ switchboard_proxy_port }}/api

    CacheEnable mem /

    <Location />
	     Order allow,deny
		 Allow from all
		 
   		 AddOutputFilterByType DEFLATE text/html
		 AddOutputFilterByType DEFLATE text/javascript
		 AddOutputFilterByType DEFLATE application/javascript
		 AddOutputFilterByType DEFLATE application/css

	</Location>
	
</VirtualHost>


<VirtualHost *:80>
     ServerName {{ switchboard_vhost }}
	 
     ProxyRequests Off
     <Proxy *>
         Order deny,allow
         Allow from all
     </Proxy>
 
     ProxyPass / http://localhost:{{ switchboard_proxy_port }}/ connectiontimeout=30 timeout=900
     ProxyPassReverse / http://localhost:{{ switchboard_proxy_port }}/

     <Location />
         Order allow,deny
         Allow from all
     </Location>
 </VirtualHost>

# <VirtualHost *:80>
#     ServerName {{ orchestra_vhost }}
# 	DocumentRoot /var/www/{{ orchestra_vhost }}/public
	
# 	RewriteEngine On
# 	RewriteRule ^/$ /orchestra-dev.html [L,P,QSA]
	
#     ProxyRequests Off
#     <Proxy *>
#         Order deny,allow
#         Allow from all
#     </Proxy>
 
#     ProxyPass / http://localhost:{{ orchestra_port }}/
#     ProxyPassReverse / http://localhost:{{ orchestra_port }}/
	
#     <Location />
#         Order allow,deny
#         Allow from all
#     </Location>
# </VirtualHost>

# NameVirtualHost *:80
# <VirtualHost *:80>
#     ServerName {{ orchestra_vhost }}
 
#     ProxyRequests Off
#     <Proxy *>
#         Order deny,allow
#         Allow from all
#     </Proxy>

#     ProxyPass / http://{{ ec2_private_ip_address }}:{{ switchboard_port }}/
#  	ProxyPassReverse / http://{{ ec2_private_ip_address }}:{{ switchboard_port }}/
	
#     <Location />
#         Order allow,deny
#         Allow from all
#     </Location>
# </VirtualHost>



